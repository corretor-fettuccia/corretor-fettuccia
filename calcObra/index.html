<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<!--This file was converted to xhtml by LibreOffice - see https://cgit.freedesktop.org/libreoffice/core/tree/filter/source/xslt for the code.-->

<head profile="http://dublincore.org/documents/dcmi-terms/">
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
    <title xml:lang="en-US">- no title specified</title>
    <meta name="DCTERMS.title" content="" xml:lang="en-US" />
    <meta name="DCTERMS.language" content="en-US" scheme="DCTERMS.RFC4646" />
    <meta name="DCTERMS.source" content="http://xml.openoffice.org/odf2xhtml" />
    <meta name="DCTERMS.issued" content="2021-08-05T08:00:29.412638928" scheme="DCTERMS.W3CDTF" />
    <meta name="DCTERMS.modified" content="2024-10-04T16:04:04.568197605" scheme="DCTERMS.W3CDTF" />
    <meta name="xsl:vendor" content="libxslt" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" hreflang="en" />
    <link rel="schema.DCTERMS" href="http://purl.org/dc/terms/" hreflang="en" />
    <link rel="schema.DCTYPE" href="http://purl.org/dc/dcmitype/" hreflang="en" />
    <link rel="schema.DCAM" href="http://purl.org/dc/dcam/" hreflang="en" />
    <link rel="stylesheet" href="./estilo.css">


    <style>
        /* Classe para inputs com valores positivos */
        #positivo {
            color: black;
            /* Cor do texto para valores positivos */
            font-weight: normal;
            /* Texto em negrito */
        }

        /* Classe para inputs com valores negativos */
        .negativo {
            color: red;
            /* Cor do texto para valores negativos */
            font-weight: bold;
            /* Texto em negrito */
        }
    </style>
</head>

<body dir="ltr">
    <table border="0" cellspacing="0" cellpadding="0" class="ta1">
        <colgroup>
            <col width="6" />
            <col width="149" />
            <col width="177" />
            <col width="9" />
            <col width="150" />
            <col width="186" />
            <col width="6" />
            <col width="99" />
        </colgroup>
        <tr class="ro1">
            <td colspan="7" style="text-align:left;width:0.136cm; " class="ce1"> </td>
            <td style="text-align:left;width:2.258cm; " class="ce6"> </td>
        </tr>
        <tr class="ro2">
            <td rowspan="24" style="text-align:left;width:0.136cm; " class="ce1"> </td>
            <td colspan="5" style="text-align:left;width:3.403cm; " class="ce4">
                <p>Regras para enquadramento da modalidade construção financiada.:</p>
            </td>
            <td rowspan="24" style="text-align:left;width:0.136cm; " class="ce5"> </td>
            <td style="text-align:left;width:2.258cm; " class="ce6"> </td>
        </tr>
        <tr class="ro2">
            <td style="text-align:left;width:3.403cm; " class="Default"> </td>
            <td colspan="4" style="text-align:left;width:4.06cm; " class="ce17">
                <p>- Não possuir financiamento ativo junto a CAIXA.</p>
            </td>
            <td style="text-align:left;width:2.258cm; " class="ce6"> </td>
        </tr>
        <tr class="ro2">
            <td style="text-align:left;width:3.403cm; " class="Default"> </td>
            <td colspan="4" style="text-align:left;width:4.06cm; " class="ce17">
                <p>- Terreno não possuir alienação junto a matricula</p>
            </td>
            <td style="text-align:left;width:2.258cm; " class="ce6"> </td>
        </tr>
        <tr class="ro2">
            <td style="text-align:left;width:3.403cm; " class="Default"> </td>
            <td colspan="4" style="text-align:left;width:4.06cm; " class="ce17">
                <p>- A obra precisa tratar de unidade UNIFAMILIAR</p>
            </td>
            <td style="text-align:left;width:2.258cm; " class="ce6"> </td>
        </tr>
        <tr class="ro2">
            <td style="text-align:left;width:3.403cm; " class="Default"> </td>
            <td colspan="4" style="text-align:left;width:4.06cm; " class="ce33">
                <p>- Pode utilizar FGTS, SE, não possuidor de imóvel. <span class="T2">(</span>consultar regras<span
                        class="T2">)</span></p>
            </td>
            <td style="text-align:left;width:2.258cm; " class="ce6"> </td>
        </tr>
        <tr class="ro2">
            <td style="text-align:left;width:3.403cm; " class="Default"> </td>
            <td style="text-align:left;width:4.06cm; " class="ce33"> </td>
            <td style="text-align:left;width:0.203cm; " class="Default"> </td>
            <td style="text-align:left;width:3.438cm; " class="Default"> </td>
            <td style="text-align:left;width:4.265cm; " class="ce6"> </td>
            <td style="text-align:left;width:2.258cm; " class="ce6"> </td>
        </tr>
        <tr class="ro3">
            <td colspan="5" style="text-align:left;width:3.403cm; " class="ce2">
                <p>Exemplo de aproveitamento fluxo financeiro da Obra/Lote</p>
            </td>
            <td style="text-align:left;width:2.258cm; " class="ce6"> </td>
        </tr>
        <tr class="ro4">
            <td style="text-align:left;width:3.403cm; " class="ce3"> </td>
            <td style="text-align:left;width:4.06cm; " class="Default"> </td>
            <td style="text-align:left;width:0.203cm; " class="Default"> </td>
            <td style="text-align:left;width:3.438cm; " class="Default"> </td>
            <td style="text-align:left;width:4.265cm; " class="ce6"> </td>
            <td style="text-align:left;width:2.258cm; " class="ce6"> </td>
        </tr>
        <tr class="ro2">
            <td style="text-align:left;width:3.403cm; " class="ce6">
                <p>TOTAL SUBSÍDIO</p>
            </td>
            <td style="text-align:right; width:4.06cm; " class="ce18"><input type="text" id="Val.Total.Subsidio"
                    value="R$ 0,00"></td>
            <td style="text-align:left;width:0.203cm; " class="ce18"> </td>
            <td style="text-align:left;width:3.438cm; " class="ce6"> </td>
            <td style="text-align:left;width:4.265cm; " class="ce6"> </td>
            <td style="text-align:left;width:2.258cm; " class="ce6"> </td>
        </tr>
        <tr class="ro2">
            <td style="text-align:left;width:3.403cm; " class="ce6">
                <p>TOTAL FGTS</p>
            </td>
            <td style="text-align:right; width:4.06cm; " class="ce18"><input type="text" id="Val.Total.FGTS"
                    value="R$ 0,00"></td>
            <td style="text-align:left;width:0.203cm; " class="ce18"> </td>
            <td style="text-align:left;width:3.438cm; " class="ce6"> </td>
            <td style="text-align:left;width:4.265cm; " class="ce6"> </td>
            <td style="text-align:left;width:2.258cm; " class="ce6"> </td>
        </tr>
        <tr class="ro2">
            <td style="text-align:left;width:3.403cm; " class="ce6">
                <p>TOTAL FINANCIADO</p>
            </td>
            <td style="text-align:right; width:4.06cm; " class="ce18">
                <p><input type="text" id="Val.Total.Financiado" value="R$ 0,00"></p>
            </td>
            <td style="text-align:left;width:0.203cm; " class="ce18"> </td>
            <td style="text-align:left;width:3.438cm; " class="ce6"> </td>
            <td style="text-align:left;width:4.265cm; " class="ce6"> </td>
            <td style="text-align:left;width:2.258cm; " class="ce6"> </td>
        </tr>
        <tr class="ro2">
            <td style="text-align:left;width:3.403cm; " class="ce6"> </td>
            <td style="text-align:left;width:4.06cm; " class="ce6"> </td>
            <td style="text-align:left;width:0.203cm; " class="ce6"> </td>
            <td style="text-align:left;width:3.438cm; " class="ce6"> </td>
            <td style="text-align:left;width:4.265cm; " class="ce6"> </td>
            <td style="text-align:left;width:2.258cm; " class="ce6"> </td>
        </tr>
        <tr class="ro2">
            <td colspan="5" style="text-align:left;width:3.403cm; " class="ce10">
                <p>COMPOSIÇÃO – VALOR MÁXIMO</p>
            </td>
            <td style="text-align:left;width:2.258cm; " class="ce6"> </td>
        </tr>
        <tr class="ro2">
            <td colspan="2" style="text-align:left;width:3.403cm; " class="ce11">
                <p>VALOR TOTAL DA COMPOSIÇÃO</p>
            </td>
            <td style="text-align:left;width:0.203cm; " class="ce36"> </td>
            <td colspan="2" style="text-align:right; width:3.438cm; " class="ce47"><input type="text"
                    id="Val.Composicao" value="R$ 0,00" disabled></td>
            <td style="text-align:left;width:2.258cm; " class="ce6"> </td>
        </tr>
        <tr class="ro2">
            <td colspan="3" style="text-align:left;width:3.403cm; " class="ce12">
                <p>LOTE</p>
            </td>
            <td colspan="2" style="text-align:left;width:3.438cm; " class="ce48">
                <p>OBRA</p>
            </td>
            <td style="text-align:left;width:2.258cm; " class="ce6"> </td>
        </tr>
        <tr class="ro2">
            <td style="text-align:left;width:3.403cm; " class="ce14">
                <p>Valor Lote</p>
            </td>
            <td style="text-align:right; width:4.06cm; " class="ce24"><input type="text" id="Val.Lote.Total"
                    value="R$ 0,00"></td>
            <td rowspan="8" style="text-align:left;width:0.203cm; " class="ce46"> </td>
            <td style="text-align:left;width:3.438cm; " class="ce49">
                <p>Valor Obra</p>
            </td>
            <td style="text-align:right; width:4.265cm; " class="ce52"><input type="text" id="Val.Obra.Total"
                    value="R$ 0,00"></td>
            <td style="text-align:left;width:2.258cm; " class="ce6"> </td>
        </tr>
        <tr class="ro2">
            <td style="text-align:left;width:3.403cm; " class="ce14">
                <p>Val. Financiado</p>
            </td>
            <td style="text-align:right; width:4.06cm; " class="ce25"><input type="text" id="Val.Lote.Financiado"
                    value="R$ 0,00"></td>
            <td style="text-align:left;width:3.438cm; " class="ce49">
                <p>Val. Financiado</p>
            </td>
            <td style="text-align:right; width:4.265cm; " class="ce53"><input type="text" id="Val.Obra.Financiado"
                    value="R$ 0,00" disabled></td>
            <td style="text-align:left;width:2.258cm; " class="ce6"> </td>
        </tr>
        <tr class="ro2">
            <td style="text-align:left;width:3.403cm; " class="ce14">
                <p>Val. Entrada cash</p>
            </td>
            <td style="text-align:right; width:4.06cm; " class="ce24"><input type="text" id="Val.Lote.Cash"
                    value="R$ 0,00" disabled></td>
            <td style="text-align:left;width:3.438cm; " class="ce49">
                <p>Val. Entrada cash</p>
            </td>
            <td style="text-align:right; width:4.265cm; " class="ce52"><input type="text" id="Val.Obra.Cash"
                    value="R$ 0,00" disabled></td>
            <td style="text-align:left;width:2.258cm; " class="ce6"> </td>
        </tr>
        <tr class="ro2">
            <td style="text-align:left;width:3.403cm; " class="ce14">
                <p>Val. Entrada FGTS</p>
            </td>
            <td style="text-align:right; width:4.06cm; " class="ce26"><input type="text" id="Val.Lote.FGTS"
                    value="R$ 0,00"></td>
            <td style="text-align:left;width:3.438cm; " class="ce50">
                <p>Val. Entrada FGTS</p>
            </td>
            <td style="text-align:right; width:4.265cm; " class="ce53"><input type="text" id="Val.Obra.FGTS"
                    value="R$ 0,00" disabled></td>
            <td style="text-align:left;width:2.258cm; " class="ce6"> </td>
        </tr>
        <tr class="ro2">
            <td style="text-align:left;width:3.403cm; " class="ce14"> </td>
            <td style="text-align:left;width:4.06cm; " class="ce24"> </td>
            <td style="text-align:left;width:3.438cm; " class="ce49">
                <p>Subsídio</p>
            </td>
            <td style="text-align:right; width:4.265cm; " class="ce53"><input type="text" id="Val.Obra.Subsidio"
                    value="R$ 0,00" disabled></td>
            <td style="text-align:left;width:2.258cm; " class="ce6"> </td>
        </tr>
        <tr class="ro2">
            <td style="text-align:left;width:3.403cm; " class="ce14"> </td>
            <td style="text-align:left;width:4.06cm; " class="ce42"> </td>
            <td style="text-align:left;width:3.438cm; " class="ce49"> </td>
            <td style="text-align:left;width:4.265cm; " class="ce54"> </td>
            <td style="text-align:left;width:2.258cm; " class="ce6"> </td>
        </tr>
        <tr class="ro2">
            <td style="text-align:left;width:3.403cm; " class="ce14">
                <p>SALDO JÁ PAGO</p>
            </td>
            <td style="text-align:right; width:4.06cm; " class="ce28"><input type="text" id="Val.Lote.JaPago"
                    value="R$ 0,00"></td>
            <td style="text-align:left;width:3.438cm; " class="ce49"> </td>
            <td style="text-align:left;width:4.265cm; " class="ce55"> </td>
            <td style="text-align:left;width:2.258cm; " class="ce6"> </td>
        </tr>
        <tr class="ro2">
            <td style="text-align:left;width:3.403cm; " class="ce14"> </td>
            <td style="text-align:left;width:4.06cm; " class="ce42"> </td>
            <td style="text-align:left;width:3.438cm; " class="ce49"> </td>
            <td style="text-align:left;width:4.265cm; " class="ce56"> </td>
            <td style="text-align:left;width:2.258cm; " class="ce6"> </td>
        </tr>
        <tr class="ro5">
            <td style="text-align:left;width:3.403cm; " class="ce7">
                <p><span class="T1">FINANCIAMENTO</span></p>
                <p><span class="T1">PARA TERRENO</span></p>
            </td>
            <td style="text-align:right; width:4.06cm; " class="ce32"><input type="text" id="Val.Lote.Total.BancoFin"
                    value="R$ 0,00" disabled class="Negrito"></td>
            <td style="text-align:left;width:0.203cm; " class="ce32"> </td>
            <td style="text-align:left;width:3.438cm; " class="ce38">
                <p>FINANCIAMENTO</p>
                <p>PARA OBRA</p>
            </td>
            <td style="text-align:right; width:4.265cm; " class="ce45"><input type="text" id="Val.Obra.Total.BancoFin"
                    value="R$ 0,00" disabled class="Negrito"></td>
            <td style="text-align:left;width:2.258cm; " class="ce6"> </td>
        </tr>
        <tr class="ro6">
            <td colspan="7" style="text-align:left;width:0.136cm; " class="ce5"> </td>
            <td style="text-align:left;width:2.258cm; " class="ce6"> </td>
        </tr>
        <tr class="ro2">
            <td style="text-align:left;width:0.136cm; " class="ce6"> </td>
            <td colspan="5" rowspan="2" style="text-align:left;width:3.403cm; " class="ce27">
                <input type="text" id="NomeCliente" value="Nome cliente.">
            </td>
            <td style="text-align:left;width:0.136cm; " class="ce6"> </td>
            <td style="text-align:left;width:2.258cm; " class="ce6"> </td>
        </tr>
        <tr class="ro2">
            <td style="text-align:left;width:0.136cm; " class="ce6"> </td>
            <td style="text-align:left;width:0.136cm; " class="ce6"> </td>
            <td style="text-align:left;width:2.258cm; " class="ce6"> </td>
        </tr>
        <tr class="ro2">
            <td style="text-align:left;width:0.136cm; " class="ce6"> </td>
            <td style="text-align:left;width:3.403cm; " class="ce6"> </td>
            <td style="text-align:left;width:4.06cm; " class="ce6"> </td>
            <td style="text-align:left;width:0.203cm; " class="ce6"> </td>
            <td style="text-align:left;width:3.438cm; " class="ce6"> </td>
            <td style="text-align:left;width:4.265cm; " class="ce6"> </td>
            <td style="text-align:left;width:0.136cm; " class="ce6"> </td>
            <td style="text-align:left;width:2.258cm; " class="ce6"> </td>
        </tr>
        <tr class="ro2">
            <td style="text-align:left;width:0.136cm; " class="ce6"> </td>
            <td style="text-align:left;width:3.403cm; " class="ce6">By ASPEN CORRESPONDENTE. 2024</td>
            <td style="text-align:left;width:4.06cm; " class="ce6"> </td>
            <td style="text-align:left;width:0.203cm; " class="ce6"> </td>
            <td style="text-align:left;width:3.438cm; " class="ce6"> </td>
            <td style="text-align:left;width:4.265cm; " class="ce6"> </td>
            <td style="text-align:left;width:0.136cm; " class="ce6"> </td>
            <td style="text-align:left;width:2.258cm; " class="ce6"> </td>
        </tr>
    </table>

    <script>
        estiloObrigatorio('NomeCliente');
    
        // Função para realizar os cálculos
        function calcularValores() {
            // Extrai valores numéricos de cada input
            let valTotalSubsidiado = extrairValorNumerico(document.getElementById('Val.Total.Subsidio').value);
            let valTotalFGTS = extrairValorNumerico(document.getElementById('Val.Total.FGTS').value);
            let valTotalFinanciado = extrairValorNumerico(document.getElementById('Val.Total.Financiado').value);
            let valObraFGTS = extrairValorNumerico(document.getElementById('Val.Obra.FGTS').value);
            let valObraTotal = extrairValorNumerico(document.getElementById('Val.Obra.Total').value);
            let ValLoteJapago = extrairValorNumerico(document.getElementById('Val.Lote.JaPago').value);
            let valLoteFGTS = extrairValorNumerico(document.getElementById('Val.Lote.FGTS').value);
            let valLoteFinanciado = extrairValorNumerico(document.getElementById('Val.Lote.Financiado').value);
            let valLoteTotal = extrairValorNumerico(document.getElementById('Val.Lote.Total').value);
    
            // Realizando os cálculos
            const valComposicao = valLoteTotal + valObraTotal;  // Soma total do lote e da obra
            const valLoteTotalBancoFin = valLoteFGTS + valLoteFinanciado; // Soma dos valores FGTS e Financiado do lote
            const valObraFinanciado = valTotalFinanciado - valLoteFinanciado; // Financiamento da obra menos o do lote
            const ValObraCash = valObraTotal - valObraFinanciado - valObraFGTS - valTotalSubsidiado;
            valObraFGTS= valTotalFGTS - valLoteFGTS;
            const vallotecash = valLoteTotal - ValLoteJapago - valLoteFinanciado - valLoteFGTS;
            // Cálculo correto do total da obra financiado
            const valObraTotalBancoFin = valObraFinanciado + valObraFGTS + valTotalSubsidiado; // Total da obra financiado
    
            // Atualizando os inputs com os resultados formatados como moeda
            atualizarInputComEstilo('Val.Composicao', valComposicao);
            atualizarInputComEstilo('Val.Lote.Total.BancoFin', valLoteTotalBancoFin);
            
            // Cálculo correto do valor total do lote disponível em caixa
            atualizarInputComEstilo('Val.Lote.Cash', vallotecash);
    
            // Cálculo correto do valor da obra subsidiado
            atualizarInputComEstilo('Val.Obra.Subsidio', valTotalSubsidiado);
            
            // Cálculo correto do FGTS da obra, subtraindo o FGTS do lote
            atualizarInputComEstilo('Val.Obra.FGTS', valObraFGTS);
            
            // Atualiza o valor financiado da obra
            atualizarInputComEstilo('Val.Obra.Financiado', valObraFinanciado);
            
            // Cálculo correto do valor disponível da obra em caixa
            atualizarInputComEstilo('Val.Obra.Cash', ValObraCash );
            
            // Atualiza o total da obra que é financiado
            atualizarInputComEstilo('Val.Obra.Total.BancoFin', valObraTotalBancoFin);
        }
    
        function estiloObrigatorio(id) {
            const input = document.getElementById(id);
            input.style.textAlign = 'center'; // Centraliza o texto
            input.style.color = 'Black'; // Cor do texto
            input.style.fontSize = '19px'; // Tamanho da fonte
            input.style.textTransform = 'uppercase'; // CAIXA ALTA
        }
    
        // Função para formatar o valor como moeda brasileira
        function formatarMoeda(valor) {
            return new Intl.NumberFormat('pt-BR', {
                style: 'currency',
                currency: 'BRL'
            }).format(valor);
        }
    
        // Função para mascarar os inputs
        function aplicarMascaraMoeda(input) {
            let valor = input.value;
            // Remover tudo que não for dígito
            valor = valor.replace(/\D/g, '');
            // Colocar a máscara de R$ 0,00
            valor = (valor / 100).toFixed(2).replace('.', ',');
            // Adicionando o separador de milhar
            valor = valor.replace(/\B(?=(\d{3})+(?!\d))/g, '.');
    
            // Atualizando o valor do input
            input.value = `R$ ${valor}`;
        }
    
        // Função para extrair o valor numérico puro (sem formatação de moeda) para cálculos
        function extrairValorNumerico(valor) {
            // Remover o "R$", os pontos e substituir a vírgula por ponto
            valor = valor.replace('R$', '').replace(/\./g, '').replace(',', '.');
            return parseFloat(valor) || 0;
        }
    
        // Função para formatar o valor como moeda e aplicar estilo
        function atualizarInputComEstilo(id, valor) {
            const input = document.getElementById(id);
    
            // Formata o valor para o formato de moeda
            input.value = formatarMoeda(valor);
    
            // Atualiza o estilo com base no valor
            const valorNumerico = extrairValorNumerico(input.value);
            if (valorNumerico <= 0) {
                input.style.backgroundColor = 'lightcoral'; // Estilo para negativo
                input.style.color = 'white'; // Cor do texto
            } else if (valorNumerico > 0) {
                input.style.backgroundColor = ''; // Estilo padrão
                input.style.color = 'black'; // Cor padrão
            }
        }
    
        // Adicionando o listener para aplicar máscara e atualizar estilo
        document.querySelectorAll('input').forEach(input => {
            // Se o input NÃO é o "NomeCliente", aplicamos a máscara e o estilo
            if (input.id !== 'NomeCliente') {
                input.addEventListener('input', function () {
                    aplicarMascaraMoeda(input);   // Aplica a máscara de moeda
                    atualizarInputComEstilo(input.id, extrairValorNumerico(input.value)); // Atualiza o estilo baseado no valor
                    calcularValores();            // Recalcula os valores
                });
            }
        });
    </script>
    








</body>

</html>